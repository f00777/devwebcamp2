{"version":3,"sources":["registro.js"],"names":["Swal","eventos","resumen","document","querySelector","querySelectorAll","forEach","boton","addEventListener","seleccionarEvento","target","length","disabled","id","dataset","titulo","parentElement","textContent","trim","mostrarEventos","fire","title","text","icon","confirmButtonText","firstChild","removeChild","limpiarEventos","evento","eventoDOM","createElement","classList","add","botonEliminar","innerHTML","onclick","filter","eliminarEvento","appendChild","noRegistro","async","e","preventDefault","regaloId","value","eventosId","map","datos","FormData","append","respuesta","fetch","method","body","resultado","json","then","location","href","token","reload"],"mappings":"OAAOA,SAAU,eAEjB,WACI,IAAIC,EAAU,GACd,MAAMC,EAAUC,SAASC,cAAc,qBAEvC,GAAGF,EAAQ,CACcC,SAASE,iBAAiB,oBAClCC,QAAQC,GAASA,EAAMC,iBAAiB,QAASC,IAO9D,SAASA,GAAkBC,OAACA,IAErBT,EAAQU,OAAS,GAEhBD,EAAOE,UAAW,EAElBX,EAAS,IAAIA,EAAS,CAClBY,GAAIH,EAAOI,QAAQD,GACnBE,OAAQL,EAAOM,cAAcZ,cAAc,mBAAmBa,YAAYC,SAK9EC,KAGAnB,KAAKoB,KAAK,CACNC,MAAO,QACPC,KAAM,gCACNC,KAAM,QACNC,kBAAmB,OAO/B,SAASL,IAIL,GAqCJ,WACI,KAAMjB,EAAQuB,YACVvB,EAAQwB,YAAYxB,EAAQuB,YAzChCE,GAEG1B,EAAQU,OAAS,EAChBV,EAAQK,QAAQsB,IACZ,MAAMC,EAAY1B,SAAS2B,cAAc,OACzCD,EAAUE,UAAUC,IAAI,oBAExB,MAAMjB,EAASZ,SAAS2B,cAAc,MACtCf,EAAOgB,UAAUC,IAAI,oBACrBjB,EAAOE,YAAcW,EAAOb,OAE5B,MAAMkB,EAAgB9B,SAAS2B,cAAc,UAC7CG,EAAcF,UAAUC,IAAI,sBAC5BC,EAAcC,UAAY,oCAC1BD,EAAcE,QAAU,YAkBpC,SAAwBtB,GACpBZ,EAAUA,EAAQmC,OAAOR,GAAUA,EAAOf,KAAOA,GAC5BV,SAASC,cAAc,aAAaS,OAC5CD,UAAW,EACxBO,IArBYkB,CAAeT,EAAOf,KAI1BgB,EAAUS,YAAYvB,GACtBc,EAAUS,YAAYL,GACtB/B,EAAQoC,YAAYT,SAGxB,CACA,MAAMU,EAAapC,SAAS2B,cAAc,KAC1CS,EAAWtB,YAAc,mDACzBsB,EAAWR,UAAUC,IAAI,mBACzB9B,EAAQoC,YAAYC,IA9DDpC,SAASC,cAAc,aAC/BI,iBAAiB,UA8EpCgC,eAAgCC,GAC5BA,EAAEC,iBAGF,MAAMC,EAAWxC,SAASC,cAAc,WAAWwC,MAC7CC,EAAY5C,EAAQ6C,IAAIlB,GAAUA,EAAOf,IAE/C,GAAwB,IAArBgC,EAAUlC,QAA6B,KAAbgC,EAOzB,YANA3C,KAAKoB,KAAK,CACNC,MAAO,QACPC,KAAM,uCACNC,KAAM,QACNC,kBAAmB,OAK3B,MAAMuB,EAAQ,IAAIC,SAClBD,EAAME,OAAO,UAAWJ,GACxBE,EAAME,OAAO,YAAaN,GAE1B,MACMO,QAAkBC,MADZ,mCACuB,CAC/BC,OAAQ,OACRC,KAAMN,IAEJO,QAAkBJ,EAAUK,OAE/BD,EAAUA,UACTtD,KAAKoB,KACD,mBACA,2FACA,WACFoC,KAAK,IAAMC,SAASC,KAAO,cAAcJ,EAAUK,OAErD3D,KAAKoB,KAAK,CACNC,MAAO,QACPC,KAAM,gBACNC,KAAM,QACNC,kBAAmB,OACpBgC,KAAK,IAAMC,SAASG,aApH/BzC,KAXR","file":"registro.js","sourcesContent":["import Swal from \"sweetalert2\";\n\n(function(){\n    let eventos = [];\n    const resumen = document.querySelector('#registro-resumen');\n\n    if(resumen){\n        const eventosBoton = document.querySelectorAll('.evento__agregar');\n        eventosBoton.forEach(boton => boton.addEventListener('click', seleccionarEvento));\n\n        const formularioRegistro = document.querySelector('#registro');\n        formularioRegistro.addEventListener('submit', submitFormulario);\n\n        mostrarEventos();\n\n        function seleccionarEvento({target}){\n\n            if(eventos.length < 5){\n                //Deshabilitar el evento\n                target.disabled = true;\n\n                eventos= [...eventos, {\n                    id: target.dataset.id,\n                    titulo: target.parentElement.querySelector('.evento__nombre').textContent.trim()\n                }];\n\n\n\n                mostrarEventos();\n            }\n            else{\n                Swal.fire({\n                    title: 'Error',\n                    text: 'Máximo 5 eventos por registro',\n                    icon: 'error',\n                    confirmButtonText: 'OK' \n                })\n            }\n\n            \n        }\n\n        function mostrarEventos(){\n            //Limpiar el html\n            limpiarEventos();\n\n            if(eventos.length > 0){\n                eventos.forEach(evento => {\n                    const eventoDOM = document.createElement('DIV');\n                    eventoDOM.classList.add('registro__evento');\n                    \n                    const titulo = document.createElement('H3');\n                    titulo.classList.add('registro__nombre');\n                    titulo.textContent = evento.titulo;\n\n                    const botonEliminar = document.createElement('BUTTON');\n                    botonEliminar.classList.add('registro__eliminar');\n                    botonEliminar.innerHTML = '<i class=\"fa-solid fa-trash\"></i>'\n                    botonEliminar.onclick = function(){\n                        eliminarEvento(evento.id);\n                    }\n\n                    //Renderizar en el html\n                    eventoDOM.appendChild(titulo);\n                    eventoDOM.appendChild(botonEliminar);\n                    resumen.appendChild(eventoDOM);\n                })\n            }\n            else{\n                const noRegistro = document.createElement('P');\n                noRegistro.textContent = 'No hay eventos, añade hasta 5 del lado izquierdo';\n                noRegistro.classList.add('registro__texto');\n                resumen.appendChild(noRegistro);\n            }\n        }\n\n        function eliminarEvento(id){\n            eventos = eventos.filter(evento => evento.id !== id);\n            const botonAgregar = document.querySelector(`[data-id=\"${id}\"]`);\n            botonAgregar.disabled = false;\n            mostrarEventos();\n        }\n\n        function limpiarEventos(){\n            while(resumen.firstChild){\n                resumen.removeChild(resumen.firstChild);\n            }\n        }\n\n        async function submitFormulario(e){\n            e.preventDefault();\n\n            //Obtener el regalo\n            const regaloId = document.querySelector('#regalo').value;\n            const eventosId = eventos.map(evento => evento.id);\n\n            if(eventosId.length === 0 || regaloId === ''){\n                Swal.fire({\n                    title: 'Error',\n                    text: 'Elige al menos un Evento y un Regalo',\n                    icon: 'error',\n                    confirmButtonText: 'OK' \n                })\n                return;\n            }\n\n            const datos = new FormData();\n            datos.append('eventos', eventosId);\n            datos.append('regalo_id', regaloId);\n            \n            const url = '/finalizar-registro/conferencias';\n            const respuesta = await fetch(url, {\n                method: 'POST',\n                body: datos\n            })\n            const resultado = await respuesta.json();\n\n            if(resultado.resultado){\n                Swal.fire(\n                    'Registro Exitoso',\n                    'Tus conferencias se han almacenado y tu registro fue exitoso, te esperamos en DevWebCamp',\n                    'success'\n                ).then(() => location.href = `/boleto?id=${resultado.token}`)\n            }else{\n                Swal.fire({\n                    title: 'Error',\n                    text: 'Hubo un error',\n                    icon: 'error',\n                    confirmButtonText: 'OK' \n                }).then(() => location.reload());\n            }\n        }\n    }\n    \n})();"]}